#! /usr/bin/env bash

# ID: rb868x 680 May 30 12:04 findOffshore.bash
# Tested on Red Hat 5.3

if [[ $# != 1 ]]; then
   echo -e "\nUSAGE: ./findOffshore.bash [suits.dat|osuits.dat]\n"
   exit 0
fi

ATTUID="^[a-zA-Z]{2}[0-9]{3}[a-zA-Z0-9]$"
FILE=$1

if [[ $FILE == "suits.dat" ]]; then
   echo $FILE
   for i in `cut -d':' -f1 /etc/passwd`; do
      if [[ $i =~ $ATTUID ]]; then
         COUNTRY=`grep $i $FILE |cut -d'|' -f14`
         if ! echo $COUNTRY |grep -qi USA; then
            echo $i $COUNTRY
         fi
      fi
   done

else
   echo $FILE
   for i in `cut -d':' -f1 /etc/passwd`; do
      if [[ $i =~ $ATTUID ]]; then
         grep -qi $i $FILE
      fi
   done
fi
